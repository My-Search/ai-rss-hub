<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <script>
        (function() {
            try {
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                }
            } catch (e) {}
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIé…ç½® - AI RSS Hub</title>
    <style>
        html { background-color: #f8fafc; }
        html[data-theme="dark"] { background-color: #272727; color: #f1f5f9; }
        body { background-color: #f8fafc; margin: 0; }
        html[data-theme="dark"] body { background-color: #272727; color: #f1f5f9; }
    </style>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="icon" type="image/svg+xml" th:href="@{/favicon.svg}">
</head>
<body>
    <div th:replace="fragments/header :: header"></div>
    
    <div class="container">
        <div class="page-header">
            <h1>AIé…ç½®</h1>
            <p class="subtitle">é…ç½®AIæ¨¡å‹ç”¨äºæ™ºèƒ½ç­›é€‰RSSå†…å®¹</p>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h2>åŸºç¡€é…ç½®</h2>
            </div>
            <div class="card-body">
                <form th:action="@{/ai-config}" method="post">
                    <div class="form-row">
                        <div class="form-group">
                            <label>API Base URL <span class="required">*</span></label>
                            <input type="url" name="baseUrl" th:value="${config?.baseUrl}" 
                                   placeholder="https://api.openai.com/v1" required>
                            <small class="form-hint">OpenAIå…¼å®¹çš„APIåœ°å€</small>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group model-name-group">
                            <label>æ¨¡å‹åç§° <span class="required">*</span></label>
                            <input type="text" name="model" th:value="${config?.model}" 
                                   placeholder="gpt-3.5-turbo" required>
                            <small class="form-hint">ä¾‹å¦‚: gpt-3.5-turbo, gpt-4, deepseek-r1</small>
                        </div>
                        
                        <div class="form-group model-type-group">
                            <label>æ¨¡å‹ç±»å‹</label>
                            <select name="isReasoningModel">
                                <option value="" th:selected="${config?.isReasoningModel == null}">è‡ªåŠ¨</option>
                                <option value="true" th:selected="${config?.isReasoningModel == 1}">ğŸ§  æ€è€ƒæ¨¡å‹</option>
                                <option value="false" th:selected="${config?.isReasoningModel == 0}">âš¡ æ ‡å‡†æ¨¡å‹</option>
                            </select>
                            <small class="form-hint">æ€è€ƒæ¨¡å‹å“åº”è¾ƒæ…¢ä½†è´¨é‡æ›´é«˜</small>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>API Key</label>
                        <input type="password" name="apiKey" th:value="${config?.apiKey}" 
                               placeholder="sk-...">
                        <small class="form-hint">ä½ çš„APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰</small>
                    </div>
                    
                    <div class="form-group">
                        <label>é»˜è®¤åˆ·æ–°é¢‘ç‡(åˆ†é’Ÿ) <span class="required">*</span></label>
                        <div class="input-with-checkbox">
                            <input type="number" name="refreshInterval" 
                                   th:value="${config?.refreshInterval != null ? config.refreshInterval : 10}" 
                                   min="1" max="1440" required>
                            <label class="inline-checkbox">
                                <input type="checkbox" name="forceUpdateSources" value="true">
                                <span>å¼ºåˆ¶æ›´æ–°æ‰€æœ‰RSSæºä¸ºæ­¤åˆ·æ–°é¢‘ç‡</span>
                            </label>
                        </div>
                        <small class="form-hint">RSSæºçš„é»˜è®¤æŠ“å–é—´éš”ï¼ŒèŒƒå›´1-1440åˆ†é’Ÿã€‚å‹¾é€‰åä¿å­˜æ—¶å°†åŒæ—¶æ›´æ–°æ‰€æœ‰RSSæºçš„åˆ·æ–°é¢‘ç‡</small>
                    </div>
                    
                    <div class="form-group">
                        <label>ç³»ç»Ÿæç¤ºè¯ <span class="required">*</span></label>
                        <textarea name="systemPrompt" rows="8" required 
                                  placeholder="ä½ æ˜¯ä¸€ä¸ªRSSå†…å®¹ç­›é€‰åŠ©æ‰‹ï¼Œè¯·æ ¹æ®ä»¥ä¸‹è§„åˆ™ç­›é€‰æ–‡ç« ...">[[${config?.systemPrompt}]]</textarea>
                        <small class="form-hint">æè¿°ä½ å¸Œæœ›AIå¦‚ä½•ç­›é€‰æ–‡ç« ï¼Œä¾‹å¦‚å…³æ³¨çš„ä¸»é¢˜ã€æ’é™¤çš„å†…å®¹ç­‰</small>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">ğŸ’¾ ä¿å­˜é…ç½®</button>
                        <a th:href="@{/dashboard}" class="btn">å–æ¶ˆ</a>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card info-card" th:if="${config != null}">
            <div class="card-header">
                <h2>âœ… é…ç½®çŠ¶æ€</h2>
            </div>
            <div class="card-body">
                <p>AIé…ç½®å·²ä¿å­˜ï¼ç°åœ¨å¯ä»¥æ·»åŠ RSSæºå¹¶è·å–ä½ çš„è®¢é˜…åœ°å€ã€‚</p>
                <div class="button-group">
                    <a th:href="@{/rss-sources}" class="btn btn-primary">ğŸ“¡ ç®¡ç†RSSæº</a>
                    <a th:href="@{/feed}" class="btn">ğŸ“° æŸ¥çœ‹æˆ‘çš„è®¢é˜…</a>
                </div>
            </div>
        </div>
        
        <div class="card help-card">
            <div class="card-header">
                <h2>ğŸ’¡ é…ç½®è¯´æ˜</h2>
            </div>
            <div class="card-body">
                <div class="help-grid">
                    <div class="help-item">
                        <div class="help-icon">
                            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                            </svg>
                        </div>
                        <div class="help-content">
                            <h4>API Base URL</h4>
                            <p>æ”¯æŒ OpenAI å®˜æ–¹ API æˆ–å…¼å®¹çš„ç¬¬ä¸‰æ–¹æœåŠ¡</p>
                        </div>
                    </div>

                    <div class="help-item">
                        <div class="help-icon">
                            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                                <line x1="4" y1="22" x2="4" y2="15"/>
                            </svg>
                        </div>
                        <div class="help-content">
                            <h4>æ¨¡å‹é€‰æ‹©</h4>
                            <p>ä¸éœ€è¦å¾ˆå¥½çš„ï¼Œæ™®é€šæ¨¡å‹å³å¯</p>
                        </div>
                    </div>

                    <div class="help-item">
                        <div class="help-icon">
                            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </div>
                        <div class="help-content">
                            <h4>åˆ·æ–°é¢‘ç‡</h4>
                            <p>å»ºè®®è®¾ç½® 10-60 åˆ†é’Ÿï¼Œé¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
